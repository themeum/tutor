// Popover Component
// RTL-aware popover positioning and styling with collision detection

@use '../tokens' as *;
@use '../mixins' as *;

.tutor-popover {
  position: fixed;
  z-index: $tutor-z-dropdown;
  max-width: 276px;
  background-color: $tutor-surface-l1;
  border: 1px solid $tutor-border-idle;
  border-radius: $tutor-radius-lg;
  box-shadow:
    0 10px 15px -3px rgba(0, 0, 0, 0.1),
    0 4px 6px -2px rgba(0, 0, 0, 0.05);

  &-header {
    padding: $tutor-spacing-4 $tutor-spacing-4 0;

    .tutor-popover-title {
      @include tutor-typography(p1, semibold, primary);
      margin: 0;
    }

    .tutor-popover-close {
      position: absolute;
      top: $tutor-spacing-2;
      right: $tutor-spacing-2;
      width: 24px;
      height: 24px;
      padding: 0;
      border: none;
      background: none;
      border-radius: $tutor-radius-5xl;
      color: $tutor-icon-idle;
      cursor: pointer;
      @include tutor-transition();

      @include tutor-flex-center();

      [dir='rtl'] & {
        right: auto;
        left: $tutor-spacing-2;
      }

      &:hover,
      &:focus {
        background-color: $tutor-surface-l2;
        color: $tutor-icon-hover;
        outline: none;
      }
    }
  }

  &-body {
    @include tutor-typography(p2, regular, primary);
    padding: $tutor-spacing-4;
  }

  &-footer {
    padding: $tutor-spacing-4;
    border-top: 1px solid $tutor-border-idle;
    margin-top: $tutor-spacing-4;

    @include tutor-flex(row, center, flex-end);
    gap: $tutor-spacing-2;

    [dir='rtl'] & {
      justify-content: flex-start;
      flex-direction: row-reverse;
    }
  }

  &-menu {
    min-width: 170px;
    padding: $tutor-spacing-3 0;

    &-item {
      width: 100%;
      @include tutor-button-reset();
      @include tutor-flex(row, center, flex-start);
      @include tutor-typography(small);
      gap: $tutor-spacing-2;
      padding: $tutor-spacing-4 $tutor-spacing-5;
      @include tutor-transition((color, background-color));

      &:hover {
        background-color: $tutor-tab-sidebar-l2-hover;
      }

      &.tutor-active {
        background-color: $tutor-tab-sidebar-l2-active;
        color: $tutor-text-brand;
        opacity: 1;
      }
    }
  }

  // Size variants
  &-sm {
    max-width: 200px;
    font-size: $tutor-font-size-p3;
  }

  &-lg {
    max-width: 400px;
  }

  &-xl {
    max-width: 500px;
  }

  // Hidden by default
  &[x-cloak] {
    display: none !important;
  }
}

// Responsive adjustments
@media (max-width: 576px) {
  .tutor-popover {
    max-width: calc(100vw - 56px);

    &-header,
    &-body,
    &-footer {
      padding-left: $tutor-spacing-3;
      padding-right: $tutor-spacing-3;
    }
  }
}
